---
title: 在 LobeHub 中配置 Google 身份验证
description: 学习如何在 LobeHub 中配置 Google SSO，包括在 Google Cloud Console 创建 OAuth 凭证和设置环境变量。
tags:
  - Google
  - 身份验证
  - LobeHub
  - 单点登录
---

# 配置 Google 身份验证

<Steps>
  ### 创建 Google OAuth 凭证

  1. 前往 [Google Cloud Console](https://console.cloud.google.com/apis/credentials)
  2. 创建新项目或选择现有项目
  3. 点击 **Create Credentials** > **OAuth client ID**
  4. 如果是首次创建，需先配置 OAuth 同意屏幕（见下方步骤）
  5. 选择 **Web application** 作为应用类型
  6. 添加授权重定向 URI（见下方回调 URL 配置）
  7. 点击创建，保存 **Client ID** 和 **Client Secret**

  ### 配置 OAuth 同意屏幕

  1. 前往 **APIs & Services** > **OAuth consent screen**
  2. 选择用户类型：
     - **External**：适用于任何 Google 账户
     - **Internal**：仅限 Google Workspace 组织用户
  3. 填写应用名称、用户支持邮箱等必填信息
  4. 添加授权范围：`email` 和 `profile`
  5. 如果处于测试模式，需添加测试用户

  ### 配置回调 URL

  在授权重定向 URI 中添加：

  <Callout type={'info'}>
    回调 URL 格式：

    - 本地开发: `http://localhost:3210/api/auth/callback/google`
    - 生产环境: `https://your-domain.com/api/auth/callback/google`
  </Callout>

  ### 配置环境变量

  | 环境变量                 | 类型 | 描述                                     |
  | -------------------- | -- | -------------------------------------- |
  | `AUTH_SECRET`        | 必选 | 会话加密密钥，使用 `openssl rand -base64 32` 生成 |
  | `AUTH_SSO_PROVIDERS` | 必选 | 填写 `google`                            |
  | `AUTH_GOOGLE_ID`     | 必选 | Google Cloud Console 中的 Client ID      |
  | `AUTH_GOOGLE_SECRET` | 必选 | Google Cloud Console 中的 Client Secret  |

  <Callout type={'tip'}>
    前往 [📘 环境变量](/zh/docs/self-hosting/environment-variables/auth#google)
    可查阅相关变量详情。
  </Callout>
</Steps>

<Callout type={'info'}>
  部署成功后，用户将可以通过 Google 身份认证并使用 LobeHub。
</Callout>

## 常见问题

### redirect\_uri\_mismatch 错误

确保 Google Cloud Console 中配置的回调 URL 与实际部署地址完全匹配，包括协议（http/https）和端口号。

### 测试模式限制

如果 OAuth 同意屏幕处于测试模式，只有添加为测试用户的 Google 账户才能登录。

## 相关资源

- [Google Cloud Console](https://console.cloud.google.com/)
- [Google OAuth 2.0 文档](https://developers.google.com/identity/protocols/oauth2)
