---
title: åœ¨ LobeHub ä¸­é…ç½® Apple èº«ä»½éªŒè¯
description: å­¦ä¹ å¦‚ä½•åœ¨ LobeHub ä¸­é…ç½® Apple ç™»å½•ï¼ŒåŒ…æ‹¬åœ¨ Apple Developer Portal åˆ›å»ºå‡­è¯å’Œè®¾ç½®ç¯å¢ƒå˜é‡ã€‚
tags:
  - Apple
  - èº«ä»½éªŒè¯
  - LobeHub
  - å•ç‚¹ç™»å½•
---

# é…ç½® Apple èº«ä»½éªŒè¯

<Callout type={'warning'}>
  Apple ç™»å½•éœ€è¦ä»˜è´¹çš„ Apple Developer è´¦æˆ·ï¼ˆ$99 / å¹´ï¼‰ï¼Œä¸”ä¸æ”¯æŒ
  localhostã€‚å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒéƒ½å¿…é¡»ä½¿ç”¨ HTTPS åŸŸåã€‚
</Callout>

<Steps>
  ### åˆ›å»º App ID

  1. å‰å¾€ [Apple Developer Portal](https://developer.apple.com/account/resources/identifiers/list)
  2. å¯¼èˆªåˆ° **Certificates, Identifiers & Profiles** > **Identifiers**
  3. ç‚¹å‡» **+** æ³¨å†Œæ–°æ ‡è¯†ç¬¦
  4. é€‰æ‹© **App IDs** > **App** ç±»å‹ > **Continue**
  5. å¡«å†™ï¼š
     - **Description**: å¦‚ `LobeHub`
     - **Bundle ID**: å¦‚ `com.yourcompany.lobechat`
  6. å¯ç”¨ **Sign In with Apple** åŠŸèƒ½
  7. ç‚¹å‡» **Continue** > **Register**

  ### åˆ›å»º Services ID

  1. è¿”å› **Identifiers**ï¼Œç‚¹å‡» **+**
  2. é€‰æ‹© **Services IDs** > **Continue**
  3. å¡«å†™ï¼š
     - **Description**: å¦‚ `LobeHub Web`
     - **Identifier**: å¦‚ `com.yourcompany.lobechat.web`ï¼ˆè¿™æ˜¯ä½ çš„ Client IDï¼‰
  4. ç‚¹å‡» **Continue** > **Register**

  ### é…ç½® Services ID

  1. ç‚¹å‡»å·²åˆ›å»ºçš„ Services ID
  2. å¯ç”¨ **Sign In with Apple**
  3. ç‚¹å‡» **Configure**
  4. é€‰æ‹© Primary App ID
  5. æ·»åŠ åŸŸåå’Œå›è°ƒ URLï¼š
     - **Domains**: `your-domain.com`
     - **Return URLs**: `https://your-domain.com/api/auth/callback/apple`
  6. ç‚¹å‡» **Save** > **Continue** > **Save**

  <Callout type={'info'}>
    å›è°ƒ URL æ ¼å¼ï¼š

    - ç”Ÿäº§ç¯å¢ƒ: `https://your-domain.com/api/auth/callback/apple`
    - Apple **ä¸æ”¯æŒ** localhost æˆ– HTTP URL
  </Callout>

  ### åˆ›å»ºç™»å½•å¯†é’¥

  1. å¯¼èˆªåˆ° **Keys**ï¼Œç‚¹å‡» **+**
  2. å¡«å†™å¯†é’¥åç§°
  3. å¯ç”¨ **Sign In with Apple**ï¼Œç‚¹å‡» **Configure**
  4. é€‰æ‹© Primary App ID
  5. ç‚¹å‡» **Save** > **Continue** > **Register**
  6. **ä¸‹è½½å¯†é’¥æ–‡ä»¶**ï¼ˆ`.p8`ï¼‰- åªèƒ½ä¸‹è½½ä¸€æ¬¡
  7. è®°å½•ï¼š
     - **Key ID**: å¯†é’¥é¡µé¢æ˜¾ç¤º
     - **Team ID**: å¼€å‘è€…é—¨æˆ·å³ä¸Šè§’æ˜¾ç¤º

  ### ç”Ÿæˆ Client Secret

  Apple è¦æ±‚ä½¿ç”¨ JWT ä½œä¸º client secretã€‚ä½¿ç”¨ `.p8` å¯†é’¥æ–‡ä»¶ç”Ÿæˆï¼š

  ```js
  // Node.js ç¤ºä¾‹
  const jwt = require('jsonwebtoken');
  const fs = require('fs');

  const privateKey = fs.readFileSync('AuthKey_XXXXX.p8');
  const token = jwt.sign({}, privateKey, {
    algorithm: 'ES256',
    expiresIn: '180d', // æœ€é•¿ 6 ä¸ªæœˆ
    issuer: 'YOUR_TEAM_ID',
    audience: 'https://appleid.apple.com',
    subject: 'YOUR_SERVICES_ID', // Client ID
    keyid: 'YOUR_KEY_ID',
  });
  ```

  <Callout type={'warning'}>
    JWT æœ€é•¿æœ‰æ•ˆæœŸä¸º 180 å¤©ã€‚éœ€è¦åœ¨è¿‡æœŸå‰é‡æ–°ç”Ÿæˆå¹¶æ›´æ–°ã€‚
  </Callout>

  ### é…ç½®ç¯å¢ƒå˜é‡

  | ç¯å¢ƒå˜é‡                               | ç±»å‹ | æè¿°                                     |
  | ---------------------------------- | -- | -------------------------------------- |
  | `AUTH_SECRET`                      | å¿…é€‰ | ä¼šè¯åŠ å¯†å¯†é’¥ï¼Œä½¿ç”¨ `openssl rand -base64 32` ç”Ÿæˆ |
  | `AUTH_SSO_PROVIDERS`               | å¿…é€‰ | å¡«å†™ `apple`                             |
  | `AUTH_APPLE_CLIENT_ID`             | å¿…é€‰ | ä½ çš„ Services ID                         |
  | `AUTH_APPLE_CLIENT_SECRET`         | å¿…é€‰ | ç”Ÿæˆçš„ JWT                                |
  | `AUTH_APPLE_APP_BUNDLE_IDENTIFIER` | å¯é€‰ | App Bundle IDï¼ˆç”¨äºåŸç”Ÿåº”ç”¨é›†æˆï¼‰                |

  <Callout type={'tip'}>
    å‰å¾€ [ğŸ“˜ ç¯å¢ƒå˜é‡](/zh/docs/self-hosting/environment-variables/auth#apple)
    å¯æŸ¥é˜…ç›¸å…³å˜é‡è¯¦æƒ…ã€‚
  </Callout>
</Steps>

<Callout type={'info'}>
  éƒ¨ç½²æˆåŠŸåï¼Œç”¨æˆ·å°†å¯ä»¥é€šè¿‡ Apple èº«ä»½è®¤è¯å¹¶ä½¿ç”¨ LobeHubã€‚
</Callout>

## å¸¸è§é—®é¢˜

### ä¸æ”¯æŒ localhost

Apple ç™»å½•ä¸æ”¯æŒ localhost æˆ–é HTTPS URLã€‚æœ¬åœ°å¼€å‘è¯·ä½¿ç”¨ ngrok ç­‰éš§é“æœåŠ¡æˆ–éƒ¨ç½²åˆ°å¸¦æœ‰ HTTPS çš„æµ‹è¯•ç¯å¢ƒã€‚

### å¯†é’¥è¿‡æœŸ

JWT client secret æœ€é•¿æœ‰æ•ˆæœŸä¸º 180 å¤©ã€‚è¯·è®¾ç½®æé†’åœ¨è¿‡æœŸå‰é‡æ–°ç”Ÿæˆã€‚

## ç›¸å…³èµ„æº

- [Apple Developer Portal](https://developer.apple.com/account)
- [Sign In with Apple æ–‡æ¡£](https://developer.apple.com/sign-in-with-apple/)
