---
title: 在 Dokploy 上部署 LobeHub
description: 本文详细介绍如何在 Dokploy 中部署 LobeHub，包括数据库配置、身份验证服务配置的设置步骤。
tags:
  - 服务端数据库
  - Postgres
  - Better Auth
  - Dokploy部署
  - 数据库配置
  - 身份验证服务
  - 环境变量配置
---

# 在 Dokploy 上部署 LobeHub

本文将详细介绍如何在 Dokploy 中部署 LobeHub。

## 一、准备工作

### 部署 Dokploy 并进行相关设置

```shell
curl -sSL https://dokploy.com/install.sh | sh
```

1. 在 Dokploy 的 Settings / Git 处根据提示将 Github 绑定到 Dokploy

![](/blog/assets0f97d1dfccd5ba07172aff71ff9acd7b.webp)

2. 进入 Projects 界面创建一个 Project

![](/blog/assetsb26b68a4875a6510ddc202dd4b40d010.webp)

### 配置 S3 存储服务

在服务端数据库中我们需要配置 S3 存储服务来存储文件，详细配置教程请参考 使用 Vercel 部署中 [配置 S3 储存服务](https://lobehub.com/zh/docs/self-hosting/platform/vercel#%E4%B8%89%E3%80%81-%E9%85%8D%E7%BD%AE-s-3-%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1)。配置完成后你将获得以下环境变量：

```shell
S3_ACCESS_KEY_ID=
S3_SECRET_ACCESS_KEY=
S3_ENDPOINT=
S3_BUCKET=
S3_ENABLE_PATH_STYLE=
```

### 配置 KEY\_VAULTS\_SECRET 环境变量

`KEY_VAULTS_SECRET` 用于加密用户存储的 API Key 等敏感信息。点击下方按钮一键生成：

<GenerateSecret envName="KEY_VAULTS_SECRET" />

### 配置身份验证环境变量

准备以下身份验证环境变量（基于 [Better Auth](https://www.better-auth.com)）：

点击下方按钮一键生成 `AUTH_SECRET`（会话加密密钥）：

<GenerateSecret envName="AUTH_SECRET" />

同时需要配置 `JWKS_KEY` 环境变量，用于签名和验证 JWT。点击下方按钮一键生成：

<GenerateJWKSKey />

<Callout type={'info'}>
  如需 SSO 登录、魔法链接登录、邮箱验证等高级功能，请参阅 [身份验证服务](/zh/docs/self-hosting/auth)。
</Callout>

## 二、在 Dokploy 上部署数据库

进入前面创建的 Project，点击 Create Service 选择 Database，在 Database 界面选择 PostgreSQL ，然后设置数据库名、用户、密码，在 Docker image 中填入 `paradedb/paradedb:latest-pg17` 最后点击 Create 创建数据库。

![](/blog/assets7006b60baaf62aa0d95cd40456e24afe.webp)

进入创建的数据库，在 External Credentials 设置一个未被占用的端口，使其能能通过外部访问，否则 LobeHub 将无法连接到该数据库。你可以在 External Host 查看 Postgres 数据库连接 URL ，如下：

```shell
postgresql://postgres:wAbLxfXSwkxxxxxx@45.577.281.48:5432/postgres
```

最后点击 Deploy 部署数据库

![](/blog/assets1b9283f9cc5fc5073ff9cffc24880e96.webp)

## 在 Dokploy 上部署 LobeHub

点击 Create Service 选择 Application，创建 LobeHub 应用

![](/blog/assetsb33085e7553d2b7194005b102184553e.webp)

进入创建的 LobeHub 应用，选择你 fork 的 lobe-chat 项目及分支，点击 Save 保存

![](/blog/assetsf0ebf396dbe9559eb3478f48f648a6e2.webp)

切换到 Environment ，在其中填入环境变量，点击保存。

![](/blog/assets6b67dabe7b9226cdff1bace5a3b8ab18.webp)

```shell
# 构建所必需的环境变量
NIXPACKS_PKGS="bun"
NIXPACKS_INSTALL_CMD="pnpm install"
NIXPACKS_BUILD_CMD="NODE_OPTIONS='--max-old-space-size=8192' pnpm run build"
NIXPACKS_START_CMD="pnpm start"

APP_URL=

# Postgres 数据库相关配置
DATABASE_DRIVER=node
DATABASE_URL=

# 使用上方生成的值
KEY_VAULTS_SECRET=
AUTH_SECRET=
JWKS_KEY=

# S3 相关配置
S3_ACCESS_KEY_ID=
S3_SECRET_ACCESS_KEY=
S3_ENDPOINT=
S3_BUCKET=
S3_ENABLE_PATH_STYLE=

```

添加完环境变量并保存后，点击 Deploy 进行部署，你可以在 Deployments 处查看部署进程及日志信息

![](/blog/assets7c3eab218c0823fa353b1cd23afe21c3.webp)

部署成功后在 Domains 页面，为你的 LobeHub 应用绑定自己的域名并申请证书。

![](/blog/assetseebf66254337ce88357629c34e78c08d.webp)

## 验证 LobeHub 是否正常工作

进入你的 LobeHub 网址，如果你点击左上角登录，可以正常显示登录弹窗，那么说明你已经配置成功了，尽情享用吧～

![](/blog/assets11a8089b511aaa61e8982dea0a3665c5.webp)
